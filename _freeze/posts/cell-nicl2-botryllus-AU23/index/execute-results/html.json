{
  "hash": "7d66cd9906d98c98b58061459899ebe0",
  "result": {
    "markdown": "---\ntitle: \"Cell culture monitoring Pilot\"\nauthor: \"Celeste Valdivia\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(ggplot2)\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\nlibrary(ggpubr)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.bash .cell-code}\ncurl -L https://docs.google.com/spreadsheets/d/13o7wsaFG9QAbBtIo31XtbfPtFOcf5HUEEYDksrcqaok/export?exportFormat=csv | tee ~/Documents/GitHub/Git/bestblogever/posts/cell-nicl2-botryllus-AU23/data/cell.csv\n```\n\n\n::: {.cell-output .cell-output-stdout}\n```\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n100   391    0   391    0     0   1305      0 --:--:-- --:--:-- --:--:--  1386\n\n100  6261    0  6261    0     0   9973      0 --:--:-- --:--:-- --:--:--  9973\ndate,experiment,plate_Number,well_Placements,treatment_mg_per_L,replicate,animal_ID,stage_2,stage_at_dissection,initials,hps,no_attached_tissue,no_mono_out,image,percent_media_replaced,tissue_total,prim_bud_no,zooid_no,float_prim,float_zooid,comments\n10/01/2023,0,1,B4,5,R1,S147C001,late,TO,CV,18,6,1,y,0,8,8,0,2,0,\n10/02/2023,0,1,B4,5,R1,S147C001,late,TO,CV,38,5,1,n,0,5,NA,NA,NA,NA,\n10/03/2023,0,1,B4,5,R1,S147C001,late,TO,CV,70,5,1,y,100,8,8,0,3,0,\n10/01/2023,0,1,C2,0,R4,S148C001,late,TO,CV,18,2,1,y,0,2,1,0,1,0,\n10/02/2023,0,1,C2,0,R4,S148C001,late,TO,CV,38,1,1,y,0,2,1,0,1,0,\n10/03/2023,0,1,C2,0,R4,S148C001,late,TO,CV,70,1,1,y,100,2,1,0,1,0,\n10/01/2023,0,1,C1,0,R2,S149C001,late,TO,CV,18,7,1,y,0,7,7,0,0,0,\n10/02/2023,0,1,C1,0,R2,S149C001,late,TO,CV,38,7,1,n,0,7,7,0,0,0,\n10/03/2023,0,1,C1,0,R2,S149C001,late,TO,CV,70,6,1,y,100,7,7,0,1,0,\n10/01/2023,0,1,A2,45,R4,S151C001,mid,B1,CV,18,10,0,y,0,10,0,10,0,0,\n10/02/2023,0,1,A2,45,R4,S151C001,mid,B1,CV,38,10,0,y,0,10,0,10,0,0,\n10/03/2023,0,1,A2,45,R4,S151C001,mid,B1,CV,70,10,0,y,100,10,0,0,0,0,\n10/01/2023,0,1,A4,0,R3,S154C001,mid,C1,CV,18,4,0,y,0,5,2,3,0,1,\n10/02/2023,0,1,A4,0,R3,S154C001,mid,C1,CV,38,4,0,n,0,5,2,3,0,1,\n10/03/2023,0,1,A4,0,R3,S154C001,mid,C1,CV,70,4,0,y,100,5,2,3,0,1,\n10/01/2023,0,1,B3,45,R1,S158C001,late,TO,CV,18,5,1,y,0,6,6,0,1,0,\n10/02/2023,0,1,B3,45,R1,S158C001,late,TO,CV,38,5,1,n,0,5,2,3,0,1,\n10/03/2023,0,1,B3,45,R1,S158C001,late,TO,CV,70,5,1,y,100,6,6,0,1,0,\n10/01/2023,0,1,A1,5,R3,S160C001,late,C2,CV,18,8,1,y,0,9,2,7,0,1,\n10/02/2023,0,1,A1,5,R3,S160C001,late,C2,CV,38,8,1,y,0,9,2,7,1,1,\n10/03/2023,0,1,A1,5,R3,S160C001,late,C2,CV,38,8,1,n,100,9,2,7,0,1,\n10/01/2023,0,1,C3,45,R2,S162C001,late,C2,CV,18,7,1,y,0,8,2,6,1,0,\n10/02/2023,0,1,C3,45,R2,S162C001,late,C2,CV,38,7,1,n,0,8,2,6,1,0,\n10/03/2023,0,1,C3,45,R2,S162C001,late,C2,CV,70,7,1,y,100,8,2,6,1,0,\n10/01/2023,0,1,A3,5,R2,S167C001,mid,B2,CV,18,5,0,y,0,7,1,6,1,1,\n10/02/2023,0,1,A3,5,R2,S167C001,mid,B2,CV,38,5,0,n,0,7,1,6,1,1,\n10/03/2023,0,1,A3,5,R2,S167C001,mid,B2,CV,70,5,0,y,100,7,1,6,1,1,\n10/01/2023,0,1,C4,0,R1,S177C001,late,C2,CV,18,3,0,y,0,6,6,0,2,0,\n10/02/2023,0,1,C4,0,R1,S177C001,late,C2,CV,38,3,0,n,0,6,6,0,3,0,\n10/03/2023,0,1,C4,0,R1,S177C001,late,C2,CV,70,3,0,y,100,6,6,0,3,0,\n10/01/2023,0,1,B2,45,R3,S178C001,early,A2,CV,18,5,0,y,0,5,5,0,0,0,\n10/02/2023,0,1,B2,45,R3,S178C001,early,A2,CV,38,5,0,n,0,5,5,0,0,0,\n10/03/2023,0,1,B2,45,R3,S178C001,early,A2,CV,70,5,0,y,100,5,5,0,0,0,\n10/01/2023,0,1,B1,5,R4,S180C001,mid,C1,CV,18,7,0,y,0,7,7,0,0,0,\n10/02/2023,0,1,B1,5,R4,S180C001,mid,C1,CV,38,7,0,n,0,7,7,0,0,0,\n10/03/2023,0,1,B1,5,R4,S180C001,mid,C1,CV,70,7,0,y,100,7,7,0,0,0,\n10/10/2023,0,1,B4,5,R1,S147C001,late,TO,CV,240,3,0,n,100,6,6,0,3,0,\n10/10/2023,0,1,C2,0,R4,S148C001,late,TO,CV,240,0,1,n,100,2,2,0,2,0,\n10/10/2023,0,1,C1,0,R2,S149C001,late,TO,CV,240,6,2,n,100,6,6,0,0,0,\n10/10/2023,0,1,A2,45,R4,S151C001,mid,B1,CV,240,7,1,y,100,7,0,7,0,0,\n10/10/2023,0,1,A4,0,R3,S154C001,mid,C1,CV,240,4,1,y,100,4,2,2,0,0,\n10/10/2023,0,1,B3,45,R1,S158C001,late,TO,CV,240,5,1,n,100,5,5,0,0,0,\n10/10/2023,0,1,A1,5,R3,S160C001,late,C2,CV,240,8,1,n,100,9,2,7,0,1,\n10/10/2023,0,1,C3,45,R2,S162C001,late,C2,CV,240,7,0,n,100,7,1,6,0,0,\n10/10/2023,0,1,A3,5,R2,S167C001,mid,B2,CV,240,4,1,y,100,5,0,5,0,1,\n10/10/2023,0,1,C4,0,R1,S177C001,late,C2,CV,240,1,1,n,100,4,4,0,3,0,\n10/10/2023,0,1,B2,45,R3,S178C001,early,A2,CV,240,4,1,n,100,4,4,0,0,0,\n10/10/2023,0,1,B1,5,R4,S180C001,mid,C1,CV,240,7,0,n,100,7,7,0,0,0,\n10/26/2023,0,1,B4,5,R1,S147C001,late,TO,CV,600,3,1,y,100,3,3,0,0,0,near 5\n10/26/2023,0,1,C2,0,R4,S148C001,late,TO,CV,600,0,1,n,0,0,0,0,0,0,\n10/26/2023,0,1,C1,0,R2,S149C001,late,TO,CV,600,6,2,n,0,6,6,0,0,0,contaminated\n10/26/2023,0,1,A2,45,R4,S151C001,mid,B1,CV,600,8,1,y,100,7,0,7,0,0,near 1\n10/26/2023,0,1,A4,0,R3,S154C001,mid,C1,CV,600,2,1,y,0,3,1,2,0,0,contaminated\n10/26/2023,0,1,B3,45,R1,S158C001,late,TO,CV,600,4,1,n,100,4,4,0,0,0,\n10/26/2023,0,1,A1,5,R3,S160C001,late,C2,CV,600,7,1,y,100,7,0,7,0,0,near 9\n10/26/2023,0,1,C3,45,R2,S162C001,late,C2,CV,600,7,0,n,100,7,1,6,0,0,\n10/26/2023,0,1,A3,5,R2,S167C001,mid,B2,CV,600,5,1,y,100,5,0,5,0,1,\n10/26/2023,0,1,C4,0,R1,S177C001,late,C2,CV,600,1,0,n,100,1,1,0,0,0,\n10/26/2023,0,1,B2,45,R3,S178C001,early,A2,CV,600,4,0,n,100,4,4,0,0,0,\n10/26/2023,0,1,B1,5,R4,S180C001,mid,C1,CV,600,6,0,n,100,6,6,0,0,0,\n10/25/2023,1,1,A1,5,R1,S200C001,,,CV,0,4,0,,,,,,,,\n10/25/2023,1,1,A2,45,R1,S218C001,,,CV,0,0,0,,,,,,,,\n10/25/2023,1,1,A3,0,R1,S209C001,,,CV,0,6,0,,,,,,,,\n10/25/2023,1,1,A4,0,R4,S212C001,,,CV,0,5,0,,,,,,,,\n10/25/2023,1,1,B1,45,R4,S207C001,,,CV,0,6,0,,,,,,,,\n10/25/2023,1,1,B2,5,R3,S199C001,,,CV,0,2,0,,,,,,,,\n10/25/2023,1,1,B3,45,R2,S215C001,,,CV,0,4,0,,,,,,,,\n10/25/2023,1,1,B4,5,R4,S246C001,,,CV,0,4,0,,,,,,,,\n10/25/2023,1,1,C1,5,R2,S248C001,,,CV,0,5,0,,,,,,,,\n10/25/2023,1,1,C2,45,R3,S224C001,,,CV,0,6,0,,,,,,,,\n10/25/2023,1,1,C3,0,R3,S228C001,,,CV,0,2,0,,,,,,,,\n10/25/2023,1,1,C4,0,R2,S247C001,,,CV,0,5,0,,,,,,,,\n10/26/2023,1,1,A1,5,R1,S200C001,,,CV,24,4,0,,,,,,,,\n10/26/2023,1,1,A2,45,R1,S218C001,,,CV,24,0,0,,,,,,,,\n10/26/2023,1,1,A3,0,R1,S209C001,,,CV,24,6,0,,,,,,,,\n10/26/2023,1,1,A4,0,R4,S212C001,,,CV,24,6,0,,,,,,,,\n10/26/2023,1,1,B1,45,R4,S207C001,,,CV,24,0,0,,,,,,,,\n10/26/2023,1,1,B2,5,R3,S199C001,,,CV,24,4,0,,,,,,,,\n10/26/2023,1,1,B3,45,R2,S215C001,,,CV,24,4,0,,,,,,,,\n10/26/2023,1,1,B4,5,R4,S246C001,,,CV,24,5,0,,,,,,,,\n10/26/2023,1,1,C1,5,R2,S248C001,,,CV,24,6,1,,,,,,,,\n10/26/2023,1,1,C2,45,R3,S224C001,,,CV,24,2,0,,,,,,,,\n10/26/2023,1,1,C3,0,R3,S228C001,,,CV,24,5,0,,,,,,,,\n10/26/2023,1,1,C4,0,R2,S247C001,,,CV,24,3,0,,,,,,,,\n10/27/2023,1,1,A1,5,R1,S200C001,,,CV,48,0,0,,,,,,,,\n10/27/2023,1,1,A2,45,R1,S218C001,,,CV,48,4,0,,,,,,,,\n10/27/2023,1,1,A3,0,R1,S209C001,,,CV,48,5,0,,,,,,,,\n10/27/2023,1,1,A4,0,R4,S212C001,,,CV,48,6,0,,,,,,,,\n10/27/2023,1,1,B1,45,R4,S207C001,,,CV,48,0,0,,,,,,,,\n10/27/2023,1,1,B2,5,R3,S199C001,,,CV,48,4,0,,,,,,,,\n10/27/2023,1,1,B3,45,R2,S215C001,,,CV,48,4,,,,,,,,,\n10/27/2023,1,1,B4,5,R4,S246C001,,,CV,48,4,,,,,,,,,\n10/27/2023,1,1,C1,5,R2,S248C001,,,CV,48,4,,,,,,,,,\n10/27/2023,1,1,C2,45,R3,S224C001,,,CV,48,5,,,,,,,,,\n10/27/2023,1,1,C3,0,R3,S228C001,,,CV,48,2,,,,,,,,,\n10/27/2023,1,1,C4,0,R2,S247C001,,,CV,48,4,,,,,,,,,\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncell <- read.csv(file = \"data/cell.csv\")  \n```\n:::\n\n\n# Cleaning up Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncell$date <- mdy(cell$date) #convert the date column from characters to true date\n\ncell_pilot <- cell[cell$experiment == 0, ] # only want the pilot experiment, experiment 1 failed in poor dissecting technique\n\n# Subset the 'cell_pilot' data frame to include rows with hps values of 18, 38, and 70\ncell_pilot2 <- cell_pilot[cell_pilot$hps %in% c(18, 38, 70), ]\n\n\ncell_fact <- cell_pilot2 %>%\n  mutate(treatment_mg_per_L = as.factor(treatment_mg_per_L)) %>%\n  mutate(animal_ID = as.factor(animal_ID)) %>%\n  mutate(date = as.factor(date))\n\n\n\nsummary(cell_fact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date      experiment  plate_Number well_Placements   \n 2023-10-01:12   Min.   :0    Min.   :1     Length:36         \n 2023-10-02:12   1st Qu.:0    1st Qu.:1     Class :character  \n 2023-10-03:12   Median :0    Median :1     Mode  :character  \n                 Mean   :0    Mean   :1                       \n                 3rd Qu.:0    3rd Qu.:1                       \n                 Max.   :0    Max.   :1                       \n                                                              \n treatment_mg_per_L  replicate            animal_ID    stage_2         \n 0 :12              Length:36          S147C001: 3   Length:36         \n 5 :12              Class :character   S148C001: 3   Class :character  \n 45:12              Mode  :character   S149C001: 3   Mode  :character  \n                                       S151C001: 3                     \n                                       S154C001: 3                     \n                                       S158C001: 3                     \n                                       (Other) :18                     \n stage_at_dissection   initials              hps        no_attached_tissue\n Length:36           Length:36          Min.   :18.00   Min.   : 1.000    \n Class :character    Class :character   1st Qu.:18.00   1st Qu.: 4.750    \n Mode  :character    Mode  :character   Median :38.00   Median : 5.000    \n                                        Mean   :41.11   Mean   : 5.611    \n                                        3rd Qu.:70.00   3rd Qu.: 7.000    \n                                        Max.   :70.00   Max.   :10.000    \n                                                                          \n  no_mono_out     image           percent_media_replaced  tissue_total   \n Min.   :0.0   Length:36          Min.   :  0.00         Min.   : 2.000  \n 1st Qu.:0.0   Class :character   1st Qu.:  0.00         1st Qu.: 5.000  \n Median :0.5   Mode  :character   Median :  0.00         Median : 7.000  \n Mean   :0.5                      Mean   : 33.33         Mean   : 6.556  \n 3rd Qu.:1.0                      3rd Qu.:100.00         3rd Qu.: 8.000  \n Max.   :1.0                      Max.   :100.00         Max.   :10.000  \n                                                                         \n  prim_bud_no       zooid_no        float_prim      float_zooid    \n Min.   :0.000   Min.   : 0.000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:1.500   1st Qu.: 0.000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :2.000   Median : 0.000   Median :1.0000   Median :0.0000  \n Mean   :3.686   Mean   : 2.543   Mean   :0.7429   Mean   :0.2857  \n 3rd Qu.:6.000   3rd Qu.: 6.000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :8.000   Max.   :10.000   Max.   :3.0000   Max.   :1.0000  \n NA's   :1       NA's   :1        NA's   :1        NA's   :1       \n   comments        \n Length:36         \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n                   \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the percent of monolayer output per seeded tissue piece based on the first 12 rows of 'attached_tissue'\npercent_output <- ((cell_fact$no_mono_out) / head(cell_fact$no_attached_tissue, 12)) * 100\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncell_fact <- cbind(cell_fact,percent_output)\n\nsummary(cell_fact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date      experiment  plate_Number well_Placements   \n 2023-10-01:12   Min.   :0    Min.   :1     Length:36         \n 2023-10-02:12   1st Qu.:0    1st Qu.:1     Class :character  \n 2023-10-03:12   Median :0    Median :1     Mode  :character  \n                 Mean   :0    Mean   :1                       \n                 3rd Qu.:0    3rd Qu.:1                       \n                 Max.   :0    Max.   :1                       \n                                                              \n treatment_mg_per_L  replicate            animal_ID    stage_2         \n 0 :12              Length:36          S147C001: 3   Length:36         \n 5 :12              Class :character   S148C001: 3   Class :character  \n 45:12              Mode  :character   S149C001: 3   Mode  :character  \n                                       S151C001: 3                     \n                                       S154C001: 3                     \n                                       S158C001: 3                     \n                                       (Other) :18                     \n stage_at_dissection   initials              hps        no_attached_tissue\n Length:36           Length:36          Min.   :18.00   Min.   : 1.000    \n Class :character    Class :character   1st Qu.:18.00   1st Qu.: 4.750    \n Mode  :character    Mode  :character   Median :38.00   Median : 5.000    \n                                        Mean   :41.11   Mean   : 5.611    \n                                        3rd Qu.:70.00   3rd Qu.: 7.000    \n                                        Max.   :70.00   Max.   :10.000    \n                                                                          \n  no_mono_out     image           percent_media_replaced  tissue_total   \n Min.   :0.0   Length:36          Min.   :  0.00         Min.   : 2.000  \n 1st Qu.:0.0   Class :character   1st Qu.:  0.00         1st Qu.: 5.000  \n Median :0.5   Mode  :character   Median :  0.00         Median : 7.000  \n Mean   :0.5                      Mean   : 33.33         Mean   : 6.556  \n 3rd Qu.:1.0                      3rd Qu.:100.00         3rd Qu.: 8.000  \n Max.   :1.0                      Max.   :100.00         Max.   :10.000  \n                                                                         \n  prim_bud_no       zooid_no        float_prim      float_zooid    \n Min.   :0.000   Min.   : 0.000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:1.500   1st Qu.: 0.000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :2.000   Median : 0.000   Median :1.0000   Median :0.0000  \n Mean   :3.686   Mean   : 2.543   Mean   :0.7429   Mean   :0.2857  \n 3rd Qu.:6.000   3rd Qu.: 6.000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :8.000   Max.   :10.000   Max.   :3.0000   Max.   :1.0000  \n NA's   :1       NA's   :1        NA's   :1        NA's   :1       \n   comments         percent_output  \n Length:36          Min.   :  0.00  \n Class :character   1st Qu.:  0.00  \n Mode  :character   Median :  5.00  \n                    Mean   : 18.81  \n                    3rd Qu.: 16.67  \n                    Max.   :100.00  \n                                    \n```\n:::\n:::\n\n\n\n# Summary Stats\n\nTissue attached:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the mean health score binned by hours post-exposure and by treatment\nmean_tissue_attached <- cell_fact %>%\n  group_by(hps, treatment_mg_per_L) %>%\n  summarise(mean_attached = round(mean(no_attached_tissue, na.rm = TRUE)))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'hps'. You can override using the `.groups`\nargument.\n```\n:::\n\n```{.r .cell-code}\n# Calculate SD\nSD_tissue_attached <- cell_fact %>%\n  group_by(hps, treatment_mg_per_L) %>%\n  summarise(SD_attached = round(sd(no_attached_tissue, na.rm = TRUE)))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'hps'. You can override using the `.groups`\nargument.\n```\n:::\n\n```{.r .cell-code}\nn <- 4\n\nSE_tissue_attached <- SD_tissue_attached$SD_attached/ sqrt(n)\n# Print the calculated mean health scores\nprint(mean_tissue_attached)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 3\n# Groups:   hps [3]\n    hps treatment_mg_per_L mean_attached\n  <int> <fct>                      <dbl>\n1    18 0                              4\n2    18 5                              6\n3    18 45                             7\n4    38 0                              4\n5    38 5                              7\n6    38 45                             7\n7    70 0                              4\n8    70 5                              6\n9    70 45                             7\n```\n:::\n\n```{.r .cell-code}\nprint(SE_tissue_attached)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.0 0.5 1.0 1.0 1.0 1.0 1.0 0.5 1.0\n```\n:::\n:::\n\n\n\n\nMonolayer output percent:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the mean \nmean_ratio_mono_out <- cell_fact %>%\n  group_by(hps, treatment_mg_per_L, stage_at_dissection, stage_2) %>%\n  summarise(percent_mean_mono = mean(percent_output, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'hps', 'treatment_mg_per_L',\n'stage_at_dissection'. You can override using the `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# Calculate SD and filter out groups with fewer than 2 observations\nSD_ratio_mono_out <- cell_fact %>%\n  group_by(hps, treatment_mg_per_L, stage_at_dissection, stage_2) %>%\n  filter(n() > 1) %>%  # Exclude groups with only one data point\n  summarise(SD_ratio_mono = sd(percent_output, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'hps', 'treatment_mg_per_L',\n'stage_at_dissection'. You can override using the `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nn <- 4\n\nSE_mono_ratio <- SD_ratio_mono_out$percent_output/ sqrt(n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Unknown or uninitialised column: `percent_output`.\n```\n:::\n\n```{.r .cell-code}\n# Print the calculated mean health scores\nprint(mean_tissue_attached)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 3\n# Groups:   hps [3]\n    hps treatment_mg_per_L mean_attached\n  <int> <fct>                      <dbl>\n1    18 0                              4\n2    18 5                              6\n3    18 45                             7\n4    38 0                              4\n5    38 5                              7\n6    38 45                             7\n7    70 0                              4\n8    70 5                              6\n9    70 45                             7\n```\n:::\n\n```{.r .cell-code}\nprint(SE_tissue_attached)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.0 0.5 1.0 1.0 1.0 1.0 1.0 0.5 1.0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# To visualize the mean health scores using ggplot2\nggplot(mean_ratio_mono_out, aes(x = hps, y = percent_mean_mono, color = stage_at_dissection)) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"Percent Monnolayer Output by Hours Post Seeding and Treatment\",\n       x = \"Hours Post Seeding\",\n       y = \"Percent Monolayer Output\",\n       color = \"stage\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nLet's make plots for the different time points. Maybe use this or may make a different appoach with facet wrap\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_mono_18hps <- mean_ratio_mono_out[mean_ratio_mono_out$hps == 18, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the ggplot with renamed hps values in facet_wrap\nggplot(mean_ratio_mono_out, aes(x = treatment_mg_per_L, y = percent_mean_mono, fill = stage_at_dissection)) +\n  geom_bar(stat = \"identity\", position = \"dodge\", width = 0.9) +\n  scale_fill_brewer(palette = \"Set2\", name = \"Stage at Dissection\") +\n  labs(x = \"Treatment (Nickel Chloride mg/L)\",\n       y = \"Percent Monolayer Output\") +\n  facet_wrap(~ hps, labeller = as_labeller(c(\"18\" = \"18 hps\", \"38\" = \"38 hps\", \"70\" = \"70 hps\")))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Convert Treatment and HoursPostExposure to factors if they are not already factors\ncell_fact$treatment_mg_per_L <- as.factor(cell_fact$treatment_mg_per_L)\ncell_fact$hps <- as.factor(cell_fact$hps)\n\n\n## Perform two-way ANOVA\nanova_result <- aov(percent_output ~ treatment_mg_per_L + stage_at_dissection + treatment_mg_per_L:stage_at_dissection , data = cell_fact)\n\n# Summarize the ANOVA results\nsummary(anova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                       Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment_mg_per_L                      2   1926     963   2.329    0.118    \nstage_at_dissection                     5  18911    3782   9.148 4.78e-05 ***\ntreatment_mg_per_L:stage_at_dissection  3   3840    1280   3.096    0.045 *  \nResiduals                              25  10336     413                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n## Meeting the ANOVA assumptions\nleveneTest(percent_output ~ treatment_mg_per_L*stage_at_dissection, data = cell_fact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value  Pr(>F)  \ngroup 10  3.0567 0.01135 *\n      25                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n#p-value > 0.05, therefore equal-variances are met\n\n\n# Check normality of residuals using Shapiro-Wilk test\nshapiro_test <- shapiro.test(residuals(anova_result))\nprint(shapiro_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anova_result)\nW = 0.66071, p-value = 7.207e-08\n```\n:::\n\n```{.r .cell-code}\n#DOES NOT meet assumption of normality\n\n#================need to transform data, arcsine used for percentage data===================\n## check for normality and homogenity again after this and rerun anova\n\np_prime <- asin(sqrt((cell_fact$percent_output+(3/8))/(length(cell_fact$percent_output)+(3/4)))) #hard to back-transform\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in asin(sqrt((cell_fact$percent_output +\n(3/8))/(length(cell_fact$percent_output) + : NaNs produced\n```\n:::\n\n```{.r .cell-code}\ncell_fact <- cbind(cell_fact, p_prime)\n\nleveneTest(p_prime ~ treatment_mg_per_L*stage_at_dissection, data = cell_fact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  9  0.7863 0.6318\n      20               \n```\n:::\n\n```{.r .cell-code}\n#p-value > 0.05, therefore equal-variances are met\n\n\n## Perform two-way ANOVA\nanova_result2 <- aov(p_prime ~ treatment_mg_per_L + stage_at_dissection + treatment_mg_per_L:stage_at_dissection , data = cell_fact)\n\n# Summarize the ANOVA results\nsummary(anova_result2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                       Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment_mg_per_L                      2 0.1747  0.0873   155.7 6.39e-13 ***\nstage_at_dissection                     5 2.1473  0.4295   765.9  < 2e-16 ***\ntreatment_mg_per_L:stage_at_dissection  2 0.3130  0.1565   279.1 2.45e-15 ***\nResiduals                              20 0.0112  0.0006                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n6 observations deleted due to missingness\n```\n:::\n\n```{.r .cell-code}\n# Check normality of residuals using Shapiro-Wilk test\nshapiro_test <- shapiro.test(residuals(anova_result2))\nprint(shapiro_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anova_result2)\nW = 0.74692, p-value = 8.125e-06\n```\n:::\n\n```{.r .cell-code}\n# p less than 0.05, so my data is normally distributed now.\n\n\n## Perform Tukey's HSD test for significant interaction\n\ntukey_result <- TukeyHSD(x= anova_result2, ordered = TRUE, conf.level = 0.95)\nprint(tukey_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n    factor levels have been ordered\n\nFit: aov(formula = p_prime ~ treatment_mg_per_L + stage_at_dissection + treatment_mg_per_L:stage_at_dissection, data = cell_fact)\n\n$treatment_mg_per_L\n           diff        lwr       upr     p adj\n0-45 0.04842524 0.02018388 0.0766666 0.0008918\n5-45 0.17518510 0.14876773 0.2016025 0.0000000\n5-0  0.12675986 0.10034249 0.1531772 0.0000000\n\n$stage_at_dissection\n              diff         lwr        upr     p adj\nC1-B2 6.337993e-02  0.01074921 0.11601065 0.0127540\nA2-B2 1.751851e-01  0.11441238 0.23595783 0.0000002\nB1-B2 1.751851e-01  0.11441238 0.23595783 0.0000002\nC2-B2 4.550625e-01  0.40544178 0.50468322 0.0000000\nTO-B2 7.197391e-01  0.66710835 0.77236979 0.0000000\nA2-C1 1.118052e-01  0.05917445 0.16443589 0.0000222\nB1-C1 1.118052e-01  0.05917445 0.16443589 0.0000222\nC2-C1 3.916826e-01  0.35245394 0.43091119 0.0000000\nTO-C1 6.563591e-01  0.61338634 0.69933194 0.0000000\nB1-A2 1.387779e-16 -0.06077272 0.06077272 1.0000000\nC2-A2 2.798774e-01  0.23025667 0.32949811 0.0000000\nTO-A2 5.445540e-01  0.49192325 0.59718469 0.0000000\nC2-B1 2.798774e-01  0.23025667 0.32949811 0.0000000\nTO-B1 5.445540e-01  0.49192325 0.59718469 0.0000000\nTO-C2 2.646766e-01  0.22544795 0.30390520 0.0000000\n\n$`treatment_mg_per_L:stage_at_dissection`\n                    diff         lwr        upr     p adj\n0:C2-45:A2  8.326673e-17 -0.07669297 0.07669297 1.0000000\n45:B1-45:A2 2.359224e-16 -0.07669297 0.07669297 1.0000000\n0:C1-45:A2  2.636780e-16 -0.07669297 0.07669297 1.0000000\n5:B2-45:A2  3.191891e-16 -0.07669297 0.07669297 1.0000000\n5:C1-45:A2  4.440892e-16 -0.07669297 0.07669297 1.0000000\n45:C2-45:A2 4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-45:A2  6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-45:A2  6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-45:A2  7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-45:A2            NA          NA         NA        NA\n5:A2-45:A2            NA          NA         NA        NA\n0:B1-45:A2            NA          NA         NA        NA\n5:B1-45:A2            NA          NA         NA        NA\n0:B2-45:A2            NA          NA         NA        NA\n45:B2-45:A2           NA          NA         NA        NA\n45:C1-45:A2           NA          NA         NA        NA\n45:TO-45:A2           NA          NA         NA        NA\n45:B1-0:C2  1.526557e-16 -0.07669297 0.07669297 1.0000000\n0:C1-0:C2   1.804112e-16 -0.07669297 0.07669297 1.0000000\n5:B2-0:C2   2.359224e-16 -0.07669297 0.07669297 1.0000000\n5:C1-0:C2   3.608225e-16 -0.07669297 0.07669297 1.0000000\n45:C2-0:C2  4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-0:C2   6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-0:C2   6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-0:C2   7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-0:C2             NA          NA         NA        NA\n5:A2-0:C2             NA          NA         NA        NA\n0:B1-0:C2             NA          NA         NA        NA\n5:B1-0:C2             NA          NA         NA        NA\n0:B2-0:C2             NA          NA         NA        NA\n45:B2-0:C2            NA          NA         NA        NA\n45:C1-0:C2            NA          NA         NA        NA\n45:TO-0:C2            NA          NA         NA        NA\n0:C1-45:B1  2.775558e-17 -0.07669297 0.07669297 1.0000000\n5:B2-45:B1  8.326673e-17 -0.07669297 0.07669297 1.0000000\n5:C1-45:B1  2.081668e-16 -0.07669297 0.07669297 1.0000000\n45:C2-45:B1 4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-45:B1  6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-45:B1  6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-45:B1  7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-45:B1            NA          NA         NA        NA\n5:A2-45:B1            NA          NA         NA        NA\n0:B1-45:B1            NA          NA         NA        NA\n5:B1-45:B1            NA          NA         NA        NA\n0:B2-45:B1            NA          NA         NA        NA\n45:B2-45:B1           NA          NA         NA        NA\n45:C1-45:B1           NA          NA         NA        NA\n45:TO-45:B1           NA          NA         NA        NA\n5:B2-0:C1   5.551115e-17 -0.07669297 0.07669297 1.0000000\n5:C1-0:C1   1.804112e-16 -0.07669297 0.07669297 1.0000000\n45:C2-0:C1  4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-0:C1   6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-0:C1   6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-0:C1   7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-0:C1             NA          NA         NA        NA\n5:A2-0:C1             NA          NA         NA        NA\n0:B1-0:C1             NA          NA         NA        NA\n5:B1-0:C1             NA          NA         NA        NA\n0:B2-0:C1             NA          NA         NA        NA\n45:B2-0:C1            NA          NA         NA        NA\n45:C1-0:C1            NA          NA         NA        NA\n45:TO-0:C1            NA          NA         NA        NA\n5:C1-5:B2   1.249001e-16 -0.07669297 0.07669297 1.0000000\n45:C2-5:B2  4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-5:B2   6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-5:B2   6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-5:B2   7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-5:B2             NA          NA         NA        NA\n5:A2-5:B2             NA          NA         NA        NA\n0:B1-5:B2             NA          NA         NA        NA\n5:B1-5:B2             NA          NA         NA        NA\n0:B2-5:B2             NA          NA         NA        NA\n45:B2-5:B2            NA          NA         NA        NA\n45:C1-5:B2            NA          NA         NA        NA\n45:TO-5:B2            NA          NA         NA        NA\n45:C2-5:C1  4.589834e-01  0.38229043 0.53567637 0.0000000\n5:C2-5:C1   6.042591e-01  0.52756615 0.68095210 0.0000000\n0:TO-5:C1   6.042591e-01  0.52756615 0.68095210 0.0000000\n5:TO-5:C1   7.084592e-01  0.63176618 0.78515213 0.0000000\n0:A2-5:C1             NA          NA         NA        NA\n5:A2-5:C1             NA          NA         NA        NA\n0:B1-5:C1             NA          NA         NA        NA\n5:B1-5:C1             NA          NA         NA        NA\n0:B2-5:C1             NA          NA         NA        NA\n45:B2-5:C1            NA          NA         NA        NA\n45:C1-5:C1            NA          NA         NA        NA\n45:TO-5:C1            NA          NA         NA        NA\n5:C2-45:C2  1.452757e-01  0.06858275 0.22196870 0.0000328\n0:TO-45:C2  1.452757e-01  0.06858275 0.22196870 0.0000328\n5:TO-45:C2  2.494758e-01  0.17278278 0.32616873 0.0000000\n0:A2-45:C2            NA          NA         NA        NA\n5:A2-45:C2            NA          NA         NA        NA\n0:B1-45:C2            NA          NA         NA        NA\n5:B1-45:C2            NA          NA         NA        NA\n0:B2-45:C2            NA          NA         NA        NA\n45:B2-45:C2           NA          NA         NA        NA\n45:C1-45:C2           NA          NA         NA        NA\n45:TO-45:C2           NA          NA         NA        NA\n0:TO-5:C2   1.110223e-16 -0.07669297 0.07669297 1.0000000\n5:TO-5:C2   1.042000e-01  0.02750706 0.18089300 0.0025628\n0:A2-5:C2             NA          NA         NA        NA\n5:A2-5:C2             NA          NA         NA        NA\n0:B1-5:C2             NA          NA         NA        NA\n5:B1-5:C2             NA          NA         NA        NA\n0:B2-5:C2             NA          NA         NA        NA\n45:B2-5:C2            NA          NA         NA        NA\n45:C1-5:C2            NA          NA         NA        NA\n45:TO-5:C2            NA          NA         NA        NA\n5:TO-0:TO   1.042000e-01  0.02750706 0.18089300 0.0025628\n0:A2-0:TO             NA          NA         NA        NA\n5:A2-0:TO             NA          NA         NA        NA\n0:B1-0:TO             NA          NA         NA        NA\n5:B1-0:TO             NA          NA         NA        NA\n0:B2-0:TO             NA          NA         NA        NA\n45:B2-0:TO            NA          NA         NA        NA\n45:C1-0:TO            NA          NA         NA        NA\n45:TO-0:TO            NA          NA         NA        NA\n0:A2-5:TO             NA          NA         NA        NA\n5:A2-5:TO             NA          NA         NA        NA\n0:B1-5:TO             NA          NA         NA        NA\n5:B1-5:TO             NA          NA         NA        NA\n0:B2-5:TO             NA          NA         NA        NA\n45:B2-5:TO            NA          NA         NA        NA\n45:C1-5:TO            NA          NA         NA        NA\n45:TO-5:TO            NA          NA         NA        NA\n5:A2-0:A2             NA          NA         NA        NA\n0:B1-0:A2             NA          NA         NA        NA\n5:B1-0:A2             NA          NA         NA        NA\n0:B2-0:A2             NA          NA         NA        NA\n45:B2-0:A2            NA          NA         NA        NA\n45:C1-0:A2            NA          NA         NA        NA\n45:TO-0:A2            NA          NA         NA        NA\n0:B1-5:A2             NA          NA         NA        NA\n5:B1-5:A2             NA          NA         NA        NA\n0:B2-5:A2             NA          NA         NA        NA\n45:B2-5:A2            NA          NA         NA        NA\n45:C1-5:A2            NA          NA         NA        NA\n45:TO-5:A2            NA          NA         NA        NA\n5:B1-0:B1             NA          NA         NA        NA\n0:B2-0:B1             NA          NA         NA        NA\n45:B2-0:B1            NA          NA         NA        NA\n45:C1-0:B1            NA          NA         NA        NA\n45:TO-0:B1            NA          NA         NA        NA\n0:B2-5:B1             NA          NA         NA        NA\n45:B2-5:B1            NA          NA         NA        NA\n45:C1-5:B1            NA          NA         NA        NA\n45:TO-5:B1            NA          NA         NA        NA\n45:B2-0:B2            NA          NA         NA        NA\n45:C1-0:B2            NA          NA         NA        NA\n45:TO-0:B2            NA          NA         NA        NA\n45:C1-45:B2           NA          NA         NA        NA\n45:TO-45:B2           NA          NA         NA        NA\n45:TO-45:C1           NA          NA         NA        NA\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}