{
  "hash": "cb9130048558070b7feca3328a2386c5",
  "result": {
    "markdown": "---\ntitle: \"Pilot *in vivo* NiCl~2~ x *Botryllus schlosseri* Exposure\"\nauthor: \"Celeste Valdivia\"\ndate: \"2023-09-28\"\ncategories: [study plans, nickel chloride]\nimage: \"v3_design.jpeg\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(hrbrthemes)\nlibrary(ggplot2)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n# Summary\n\nPilot study for NiCl~2~ exposures on whole field-sourced *Botryllus schlosseri* colonies.\n\n## Objectives\n\n-   Promote cell proliferation *in vitro* through the induction of clastogenic damage of epithelial cells derived from *B. schlosseri*.\n\n-   If no changes are observed across the different treatments in this pilot study, identify the ideal sample size, identify manipulations to the independent variables, time or concentration of NiCl~2~.\n\n# Research Questions\n\n1.  Does an in vivo exposure to NiCl~2~ promote in vitro cellular proliferation of epithelial tissue subsequently seeded post exposure?\n\n2.  What is the rate of cell division that occurs within those first 24 hours?\n\n3.  How does exposure to nickel chloride impact gene expression in epithelial tissue across the different concentrations after 24 hours post exposure in vivo and 76 hours post seeding?\n\n# Suggestions for Experimental Design\n\nDr. Gardell's suggested modifications to design 09/01/23:\n\n-   Log distribution of the concentrations.\n\n-   qPCR should be left for follow up experiment with better defined (targeted) concentrations and time points. Do not snap freeze tissue for qPCR, alternatively use tissue for:\n\n-   Primary epithelial cell culturing to address question regarding stress-induced evolution\n\n-   Use for comet assay\n\nValerie (UCD) Suggestions 09/23/23:\n\n-   Seed tissue immediately after dissection to avoid lag time in TCM aliquot.\n\n-   Reduce scale for preliminary trial to avoid 9 hours of micro-dissection time.\n\n# Final Experimental Schematic\n\n![](v3_design.jpeg)\n\n## Notes and considerations\n\nWill not control for blastogenic stage at this time.\n\n-   If system is in C2 - D blastogenic stages, seed the primary buds\n\n-   If system is in A1-C1 stages, seed the parental zooids\n\nTissue seeding density\n\n-   5-9 zooids (one whole system) in one well.\n\nUsing well plates, however, we will need to control for evaporation more effectively, currently randomly lose anywhere from 30-50% of the media, drastically causing differences in the osmolarity of the wells.\n\n-   Improve humidity conditions\n\n-   Add a lot of media from initiation. 2 mL in each well.\n\n-   Ideal to measure media quality.\n\n-   Randomize well assignments\n\nCould be interesting to incorporate in future design, freezing tissue at the end of the exposure and then freezing after seeding. Evaluating differences in gene expression across those time points.\n\n# Experimental Planning\n\n## Animal Handling Prior to Exposure\n\nDivided animals into separate system, 3 days prior to start of exposure, 8 days acclimated to the recirculating system.\n\n## Randomize Treatment and Plate Assignments\n\nHere we will have R randomly assign each animal to a treatment and each treatment/animal to a different well on the plate. The idea here is to randomize placements as there may be variations in the well design.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(3455)\nplate_number_12_well <- c(rep(1, times = 12))\nwell_placements <- c(\"A1\", \"A2\", \"A3\", \"A4\", \"B1\", \"B2\", \"B3\", \"B4\", \"C1\", \"C3\", \"C2\", \"C4\")\nconditions <- c(\"Control R1\", \"Control R2\", \"Control R3\", \"Control R4\", \"5 mg/L R1\", \"5 mg/L R2\", \"5 mg/L R3\", \"5 mg/L R4\", \"45 mg/L R1\", \"45 mg/L R2\", \"45 mg/L R3\", \"45 mg/L R4\")\nanimal_id <- c(\"S177C001\", \"S178C001\", \"S160C001\", \"S162C001\", \"S167C001\", \"S151C001\", \"S180C001\", \"S154C001\", \"S148C001\", \"S147C001\", \"S149C001\", \"S158C001\")\nwell_assignments <- data.frame(\n  Plate_Number = sample(plate_number_12_well),\n  Well_Placements = sample(well_placements),\n  Conditions = sample(conditions),\n  animal_ID = sample(animal_id)\n)\nprint(well_assignments)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Plate_Number Well_Placements Conditions animal_ID\n1             1              A2 45 mg/L R4  S151C001\n2             1              B4  5 mg/L R1  S147C001\n3             1              B2 45 mg/L R3  S178C001\n4             1              B1  5 mg/L R4  S180C001\n5             1              A1  5 mg/L R3  S160C001\n6             1              A3  5 mg/L R2  S167C001\n7             1              A4 Control R3  S154C001\n8             1              C4 Control R1  S177C001\n9             1              B3 45 mg/L R1  S158C001\n10            1              C2 Control R4  S148C001\n11            1              C1 Control R2  S149C001\n12            1              C3 45 mg/L R2  S162C001\n```\n:::\n\n```{.r .cell-code}\n#save assignments in csv for downstream use as metadata\nwrite.csv(well_assignments, file = \"data/pilot_random_assignments.csv\")\n```\n:::\n\n\n![plate assignments](12.jpeg)\n\n## Nickel Chloride Dilutions\n\nReview resources prior to handling nickel chloride:\n\n-   Nickel chloride [SDS](https://www.fishersci.com/store/msds?partNumber=AC270510050&productDescription=NICKEL%28II%29+CHLORIDE+HEXA+5KG&vendorId=VN00032119&countryCode=US&language=en).\n\n-   [Chemical resistance of gloves.](https://amo-csd.lbl.gov/downloads/Chemical%20Resistance%20of%20Gloves.pdf)\n\nAll handling of stock solution and treatments to be done in a chemical fume hood. Once spiked water has been distributed, add animals, parafilm jars, place in secondary container, and move to environmental chamber.\n\n### Required Volume of Artificial Seawater\n\nCalculations for spiking artificial seawater. 225 mL of seawater required to mostly submerge glass slide in wide mouth 16 oz Kerr mason jar.\n\nConsiderations:\n\n-   4 replicates\n\n-   225 mL per jar\n\n-   3 conditions\n\n-   Account for 10% loss of water during transferring\n\n$$(4*225 * 3) + (0.1*(4*225*3)) = 2,970$$\n\nNeed 2,970 mL of artificial seawater total for exposure, particularly, 990 mL of artificial seawater per condition.\n\n### Calculations\n\nStock solution of NiCl~2~ made by undergraduate Gina Jones on 02/08/23.\n\n-   NiCl~2~\n\n-   Suspended in MilliQ water (0 PPT)\n\n#### Low Dose: 5 mg/L\n\n$$ C_1*V_1 = C_2*V_2$$ $$ 1 g/L * V_1 = 0.005g/L*0.99L$$ $$V_1 = 0.00495 L = 4.95 mL$$ Spike 990 mL of aerated, artificial seawater (16 C) with 4.95 mL of stock NiCl~2~ solution. Change in salinity negligible (+/- 1 PPT).\n\n#### High Dose: 45 mg/L\n\n$$ C_1*V_1 = C_2*V_2$$ $$ 1 g/L * V_1 = 0.045g/L*0.99L$$ $$V_1 = 0.04455 L = 44.55 mL$$ Spike 990 mL of aerated, artificial seawater (16 C) with 44.55 mL of stock NiCl~2~ solution. Change in salinity negligible (+/- 1 PPT).\n\n# Protocol\n\n1.  Subdivide animals 3 days prior to exposure start.\n\n2.  Make sufficient volume of artificial seawater at appropriate salinity, 25 PPT, to match recirculating seawater system parameters. In this case for a 3 x 4 exposure at 250 mL, will require about 7 L of artificial seawater.\n\n-   30.8 g / L of Red Sea Salt\n\n3.  Rinse all glassware to be used during exposure as follows:\n\n-   Triplicate rinse with lab detergent\n\n-   Triplicate rinse with tap water\n\n-   Triplicate rinse with DI water\n\n4.  Add lab bench paper to environmental chambers top rack to reduce light intensity. Include 4 slits in bench paper to allow for air flow.\n\n5.  Add 1000 mL of artificial seawater to three 1 L beakers and place in environmental chamber (set to ambient 23 C to achieve 16 C for water) with gentle aeration (targeting \\~ 67 % DO) in preparation the night before exposure.\n\n#### *Day of Exposure Commencement*\n\n6.  Take 10 mL from each 1 L beaker and document temperature, DO, pH, salinity, and ammonia of artificial seawater prior to spiking the water.\n\n7.  In a chemical fume hood add the appropriate volume to achieve desired concentration of nickel chloride concentration to each of the 1 L beakers using a 25 mL or 50 mL serological pipette. Be sure to homogenize solution well with the serological pipette. Distribute 225 mL of each stock to the appropriate mason jar or beaker using designated serological pipette.\n\n8.  Transfer animals to a portable container with artificial seawater from the recirculating system. Image the animals using the Excelis stereomicroscope. Use a razor blade to clean around the animal and to clean glass slide of excess algae and debris.\n\n-   Document stage, zooid number, cumulative system number.\n\n9.  Distribute animals to appropriate jar in fume hood.\n\n10. Parafilm jar and place in secondary container.\n\n11. Transfer secondary container with jars to second rack of environmental chamber.\n\n12. Leave animals for 24 hours.\n\n#### *Day of Dissections*\n\nOrder of Takedown:\n\n1.  5-R3\n2.  45-R4\n3.  5-R2\n4.  0-R3\n5.  5-R4\n6.  45-R3\n7.  45-R1\n8.  5-R1\n9.  0-R2\n10. 0-R4\n11. 45-R2\n12. 0-R1\n\nThe following steps should be conducted in a chemical fume hood and iterated through one beaker at a time to avoid desiccation stress:\n\n13. Remove 100% of the exposure water from beaker and dispose of NiCl~2~ dosed artificial seawater in the appropriately marked hazardous waste container.\n\n14. With the animal and glass slide still in the beaker, quadruplicate rinse the glass slide and animal with deionized water.\n\n15. Glass slide may now be handled with nitrile gloves and should be quadruplicate rinsed with artificial seawater over exposure beaker.\n\n16. Transfer glass slide and animal to a fresh 16 oz mason jar containing 200 mL of 15 C artificial seawater.\n\n17. Dispose of excess liquid in exposure beaker in appropriately labeled hazardous waste container.\n\nYou may now work outside the chemical fumehood. Note there may be residual NiCl~2~ in animal so continue to wear the appropriate PPE and work carefully.\n\n18. Using a stainless steel razor blade, remove one of the two cumulative systems on the glass slide. Use forceps to transfer cumulative system to appropriately labeled snap cap 1.5 mL eppendorf PCR safe tube containing 500 uL of RNAProtect by Qiagen.\n\n19. Proceed with dissection of the primary buds or zooids of the second cumulative system on the slide. Refer to [epithelial isolation protocol](https://valeste.github.io/tough-tunicates/posts/epi-isolation-protocol/)\n\n-   However, avoid using any ethanol in this procedure.\n\n20. Once tissue has been removed, take cell strainer and rinse it with 30 mL ASW-PSA.\n\n21. Place tissue in aliquot of TCM and immediately go to seed tissue in biosaftey cabinet. Mark time of seeding.\n\n22. No replacement of media over course of trial.\n\n23. Transfer samples containing cumulative system suspended in RNAProtect to -20 C freezer overnight. The following day, transfer samples to -80 C freezer for long term storage.\n\n# Data\n\n## Morphometric Records\n\nMake sure you have made your Google sheet publicly available to anyone that has the link. If you make any updates to the sheet just re-curl the data, meaning just re-run the code below.\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n\ncurl -L https://docs.google.com/spreadsheets/d/10uM3N3PD9xIP4yUnadfhkcXa8TPMRMD-adOIKbmkYzY/export?exportFormat=csv | tee ~/tough-tunicates/posts/nicl2-botryllus-pilot/data/morph.csv\n```\n:::\n\n\n### Data clean up\n\nRead in the data into your environment:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmorph <- read.csv(file = \"data/morph.csv\")  \n```\n:::\n\nManipulate and clean up data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmorph$date <- mdy(morph$date) #convert the date column from characters to true date\n\nmorph <- morph %>%\n  separate(jar_id, c(\"treatment_mg_per_L\", \"replicate\"), sep = \"-\") #create two new columns, treatment and replicate from jar id \n\nmorph_fact <- morph %>%\n  mutate(treatment_mg_per_L = as.factor(treatment_mg_per_L)) %>%\n  mutate(stage = as.factor(stage)) %>%\n  mutate(animal_id = as.factor(animal_id)) %>%\n  mutate(date = as.factor(date)) %>%\n  mutate(treatment_order = factor(paste(treatment_mg_per_L, animal_id))) # Create a new variable for ordering by treatment\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(morph_fact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date      initials         stage       hpe     treatment_mg_per_L\n 2023-09-29:12   Length:24          A1:1   Min.   : 0   0 :8              \n 2023-09-30:12   Class :character   A2:1   1st Qu.: 0   45:8              \n                 Mode  :character   B1:4   Median :12   5 :8              \n                                    B2:3   Mean   :12                     \n                                    C1:5   3rd Qu.:24                     \n                                    C2:6   Max.   :24                     \n                                    TO:4                                  \n  replicate            animal_id      no_sys       no_prim_sys1  \n Length:24          S147C001: 2   Min.   :1.000   Min.   : 7.00  \n Class :character   S148C001: 2   1st Qu.:1.000   1st Qu.: 8.00  \n Mode  :character   S149C001: 2   Median :1.000   Median :10.50  \n                    S151C001: 2   Mean   :1.458   Mean   :10.83  \n                    S154C001: 2   3rd Qu.:2.000   3rd Qu.:13.00  \n                    S158C001: 2   Max.   :2.000   Max.   :22.00  \n                    (Other) :12                                  \n  no_prim_sys2       image             comments            treatment_order\n Min.   : 0.000   Length:24          Length:24          0 S148C001 : 2    \n 1st Qu.: 0.000   Class :character   Class :character   0 S149C001 : 2    \n Median : 3.000   Mode  :character   Mode  :character   0 S154C001 : 2    \n Mean   : 4.667                                         0 S177C001 : 2    \n 3rd Qu.: 8.250                                         45 S151C001: 2    \n Max.   :14.000                                         45 S158C001: 2    \n                                                        (Other)    :12    \n```\n:::\n:::\n\n### Exploratory plots\n\nLollipop chart to visualize the jumps or arrests in blastogenic stage progression for each animal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the plot\nggplot(data = morph_fact, aes(x = stage, y = treatment_order, color = date)) +\n  geom_point(size = 3, position = position_jitter(h = 0.1, w = 0)) +\n  geom_line(aes(group = treatment_order), size = 0.5, color = 'grey') +\n  labs(title = \"Blastogenic Stage Change Over Two Days\",\n       x = \"Stage\", y = \"Treatment Group - Animal ID\") +\n  scale_color_brewer(palette = \"Set1\") +\n  theme_minimal() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Analyzing differences in blastogenic progression across treatments\n\nSince all the animals start at different blastogenic stages, we will need to quantify changes in blastogenic rate with a numeric scale\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define a numeric scale\nblastogenic_scale <- c(\"A1\", \"A2\", \"B1\", \"B2\", \"C1\", \"C2\", \"TO\")\nnumeric_scale <- 1:7\n\n# Create a new variable with the numeric scale\nmorph <- morph %>%\n  mutate(stage_numeric = as.integer(factor(stage, levels = blastogenic_scale, labels = numeric_scale)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(morph)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      date              initials            stage                hpe    \n Min.   :2023-09-29   Length:24          Length:24          Min.   : 0  \n 1st Qu.:2023-09-29   Class :character   Class :character   1st Qu.: 0  \n Median :2023-09-29   Mode  :character   Mode  :character   Median :12  \n Mean   :2023-09-29                                         Mean   :12  \n 3rd Qu.:2023-09-30                                         3rd Qu.:24  \n Max.   :2023-09-30                                         Max.   :24  \n treatment_mg_per_L  replicate          animal_id             no_sys     \n Length:24          Length:24          Length:24          Min.   :1.000  \n Class :character   Class :character   Class :character   1st Qu.:1.000  \n Mode  :character   Mode  :character   Mode  :character   Median :1.000  \n                                                          Mean   :1.458  \n                                                          3rd Qu.:2.000  \n                                                          Max.   :2.000  \n  no_prim_sys1    no_prim_sys2       image             comments        \n Min.   : 7.00   Min.   : 0.000   Length:24          Length:24         \n 1st Qu.: 8.00   1st Qu.: 0.000   Class :character   Class :character  \n Median :10.50   Median : 3.000   Mode  :character   Mode  :character  \n Mean   :10.83   Mean   : 4.667                                        \n 3rd Qu.:13.00   3rd Qu.: 8.250                                        \n Max.   :22.00   Max.   :14.000                                        \n stage_numeric  \n Min.   :1.000  \n 1st Qu.:3.750  \n Median :5.000  \n Mean   :4.833  \n 3rd Qu.:6.000  \n Max.   :7.000  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Group by treatment and animal_id, then count stage skips\nskips_data <- morph %>%\n  group_by(treatment_mg_per_L, animal_id) %>%\n  summarize(skips = max(stage_numeric) - min(stage_numeric))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'treatment_mg_per_L'. You can override\nusing the `.groups` argument.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Calculate standard deviations for each treatment\nstd_dev <- skips_data %>%\n  group_by(treatment_mg_per_L) %>%\n  summarize(std_dev = sd(skips))\n\n# Calculate means for each treatment\nmeans_data <- skips_data %>%\n  group_by(treatment_mg_per_L) %>%\n  summarize(mean_skips = mean(skips))\n\ncombined_data <- left_join(std_dev, means_data, by = \"treatment_mg_per_L\")\n\nprint(combined_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  treatment_mg_per_L std_dev mean_skips\n  <chr>                <dbl>      <dbl>\n1 0                     0.5        1.25\n2 45                    1.89       1.25\n3 5                     1.41       2   \n```\n:::\n\n```{.r .cell-code}\n# Create a bar graph with adjusted error bars\nbar_plot2 <- ggplot(combined_data, aes(x = treatment_mg_per_L, y = mean_skips, fill = treatment_mg_per_L)) +\n  geom_bar(stat = \"identity\", position = \"dodge\", width = 0.7) +\n  geom_errorbar(aes(ymin = pmax(mean_skips - std_dev, 0), ymax = mean_skips + std_dev), \n                width = 0.2, position = position_dodge(width = 0.7)) +\n  labs(title = \"Blastogenic Stage Skips by Treatment\",\n       x = \"Treatment (mg/L)\",\n       y = \"Mean Skips\") +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme_minimal() +\n  theme(legend.position = \"top\")\n\n# Display the bar graph\nprint(bar_plot2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform a Kruskal-Wallis test to compare the treatments\nkruskal.test(combined_data$mean_skips ~ combined_data$treatment_mg_per_L)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  combined_data$mean_skips by combined_data$treatment_mg_per_L\nKruskal-Wallis chi-squared = 2, df = 2, p-value = 0.3679\n```\n:::\n:::\n\n\n## Cell culture monitoring\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncell_culture <- read.csv(file = \"data/pilot_random_assignments.csv\")\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}