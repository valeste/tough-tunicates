<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Celeste Valdivia">
<meta name="dcterms.date" content="2023-09-28">

<title>Celeste Valdivia’s Open Lab Notebook - Pilot in vivo NiCl2 x Botryllus schlosseri Exposure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/Valdivia.JPG" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/thumbnail.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Celeste Valdivia’s Open Lab Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/valeste" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/celestevaldivia/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="malito:cvaldi@uw.edu" rel="" target=""><i class="bi bi-envelope-heart" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Pilot <em>in vivo</em> NiCl<sub>2</sub> x <em>Botryllus schlosseri</em> Exposure</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">study plans</div>
                <div class="quarto-category">nickel chloride</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Celeste Valdivia </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 28, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  </ul></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions</a></li>
  <li><a href="#suggestions-for-experimental-design" id="toc-suggestions-for-experimental-design" class="nav-link" data-scroll-target="#suggestions-for-experimental-design">Suggestions for Experimental Design</a></li>
  <li><a href="#final-experimental-schematic" id="toc-final-experimental-schematic" class="nav-link" data-scroll-target="#final-experimental-schematic">Final Experimental Schematic</a>
  <ul class="collapse">
  <li><a href="#notes-and-considerations" id="toc-notes-and-considerations" class="nav-link" data-scroll-target="#notes-and-considerations">Notes and considerations</a></li>
  </ul></li>
  <li><a href="#experimental-planning" id="toc-experimental-planning" class="nav-link" data-scroll-target="#experimental-planning">Experimental Planning</a>
  <ul class="collapse">
  <li><a href="#animal-handling-prior-to-exposure" id="toc-animal-handling-prior-to-exposure" class="nav-link" data-scroll-target="#animal-handling-prior-to-exposure">Animal Handling Prior to Exposure</a></li>
  <li><a href="#randomize-treatment-and-plate-assignments" id="toc-randomize-treatment-and-plate-assignments" class="nav-link" data-scroll-target="#randomize-treatment-and-plate-assignments">Randomize Treatment and Plate Assignments</a></li>
  <li><a href="#nickel-chloride-dilutions" id="toc-nickel-chloride-dilutions" class="nav-link" data-scroll-target="#nickel-chloride-dilutions">Nickel Chloride Dilutions</a>
  <ul class="collapse">
  <li><a href="#required-volume-of-artificial-seawater" id="toc-required-volume-of-artificial-seawater" class="nav-link" data-scroll-target="#required-volume-of-artificial-seawater">Required Volume of Artificial Seawater</a></li>
  <li><a href="#calculations" id="toc-calculations" class="nav-link" data-scroll-target="#calculations">Calculations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#protocol" id="toc-protocol" class="nav-link" data-scroll-target="#protocol">Protocol</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#curling-google-sheet" id="toc-curling-google-sheet" class="nav-link" data-scroll-target="#curling-google-sheet">Curling Google Sheet</a></li>
  <li><a href="#data-clean-up" id="toc-data-clean-up" class="nav-link" data-scroll-target="#data-clean-up">Data clean up</a></li>
  <li><a href="#exploratory-plots" id="toc-exploratory-plots" class="nav-link" data-scroll-target="#exploratory-plots">Exploratory plots</a></li>
  <li><a href="#analyzing-differences-in-blastogenic-progression-across-treatments" id="toc-analyzing-differences-in-blastogenic-progression-across-treatments" class="nav-link" data-scroll-target="#analyzing-differences-in-blastogenic-progression-across-treatments">Analyzing differences in blastogenic progression across treatments</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Either Arial Narrow or Roboto Condensed fonts are required to use these themes.
      Please use hrbrthemes::import_roboto_condensed() to install Roboto Condensed and
      if Arial Narrow is not on your system, please see https://bit.ly/arialnarrow</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="summary" class="level1">
<h1>Summary</h1>
<p>Pilot study for NiCl<sub>2</sub> exposures on whole field-sourced <em>Botryllus schlosseri</em> colonies.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ul>
<li><p>Promote cell proliferation <em>in vitro</em> through the induction of clastogenic damage of epithelial cells derived from <em>B. schlosseri</em>.</p></li>
<li><p>If no changes are observed across the different treatments in this pilot study, identify the ideal sample size, identify manipulations to the independent variables, time or concentration of NiCl<sub>2</sub>.</p></li>
</ul>
</section>
</section>
<section id="research-questions" class="level1">
<h1>Research Questions</h1>
<ol type="1">
<li><p>Does an in vivo exposure to NiCl<sub>2</sub> promote in vitro cellular proliferation of epithelial tissue subsequently seeded post exposure?</p></li>
<li><p>What is the rate of cell division that occurs within those first 24 hours?</p></li>
<li><p>How does exposure to nickel chloride impact gene expression in epithelial tissue across the different concentrations after 24 hours post exposure in vivo and 76 hours post seeding?</p></li>
</ol>
</section>
<section id="suggestions-for-experimental-design" class="level1">
<h1>Suggestions for Experimental Design</h1>
<p>Dr.&nbsp;Gardell’s suggested modifications to design 09/01/23:</p>
<ul>
<li><p>Log distribution of the concentrations.</p></li>
<li><p>qPCR should be left for follow up experiment with better defined (targeted) concentrations and time points. Do not snap freeze tissue for qPCR, alternatively use tissue for:</p></li>
<li><p>Primary epithelial cell culturing to address question regarding stress-induced evolution</p></li>
<li><p>Use for comet assay</p></li>
</ul>
<p>Valerie (UCD) Suggestions 09/23/23:</p>
<ul>
<li><p>Seed tissue immediately after dissection to avoid lag time in TCM aliquot.</p></li>
<li><p>Reduce scale for preliminary trial to avoid 9 hours of micro-dissection time.</p></li>
</ul>
</section>
<section id="final-experimental-schematic" class="level1">
<h1>Final Experimental Schematic</h1>
<p><img src="v3_design.jpeg" class="img-fluid"></p>
<section id="notes-and-considerations" class="level2">
<h2 class="anchored" data-anchor-id="notes-and-considerations">Notes and considerations</h2>
<p>Will not control for blastogenic stage at this time.</p>
<ul>
<li><p>If system is in C2 - D blastogenic stages, seed the primary buds</p></li>
<li><p>If system is in A1-C1 stages, seed the parental zooids</p></li>
</ul>
<p>Tissue seeding density</p>
<ul>
<li>5-9 zooids (one whole system) in one well.</li>
</ul>
<p>Using well plates, however, we will need to control for evaporation more effectively, currently randomly lose anywhere from 30-50% of the media, drastically causing differences in the osmolarity of the wells.</p>
<ul>
<li><p>Improve humidity conditions</p></li>
<li><p>Add a lot of media from initiation. 2 mL in each well.</p></li>
<li><p>Ideal to measure media quality.</p></li>
<li><p>Randomize well assignments</p></li>
</ul>
<p>Could be interesting to incorporate in future design, freezing tissue at the end of the exposure and then freezing after seeding. Evaluating differences in gene expression across those time points.</p>
</section>
</section>
<section id="experimental-planning" class="level1">
<h1>Experimental Planning</h1>
<section id="animal-handling-prior-to-exposure" class="level2">
<h2 class="anchored" data-anchor-id="animal-handling-prior-to-exposure">Animal Handling Prior to Exposure</h2>
<p>Divided animals into separate system, 3 days prior to start of exposure, 8 days acclimated to the recirculating system.</p>
</section>
<section id="randomize-treatment-and-plate-assignments" class="level2">
<h2 class="anchored" data-anchor-id="randomize-treatment-and-plate-assignments">Randomize Treatment and Plate Assignments</h2>
<p>Here we will have R randomly assign each animal to a treatment and each treatment/animal to a different well on the plate. The idea here is to randomize placements as there may be variations in the well design.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3455</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plate_number_12_well <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> <span class="dv">12</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>well_placements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>, <span class="st">"B4"</span>, <span class="st">"C1"</span>, <span class="st">"C3"</span>, <span class="st">"C2"</span>, <span class="st">"C4"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Control R1"</span>, <span class="st">"Control R2"</span>, <span class="st">"Control R3"</span>, <span class="st">"Control R4"</span>, <span class="st">"5 mg/L R1"</span>, <span class="st">"5 mg/L R2"</span>, <span class="st">"5 mg/L R3"</span>, <span class="st">"5 mg/L R4"</span>, <span class="st">"45 mg/L R1"</span>, <span class="st">"45 mg/L R2"</span>, <span class="st">"45 mg/L R3"</span>, <span class="st">"45 mg/L R4"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>animal_id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S177C001"</span>, <span class="st">"S178C001"</span>, <span class="st">"S160C001"</span>, <span class="st">"S162C001"</span>, <span class="st">"S167C001"</span>, <span class="st">"S151C001"</span>, <span class="st">"S180C001"</span>, <span class="st">"S154C001"</span>, <span class="st">"S148C001"</span>, <span class="st">"S147C001"</span>, <span class="st">"S149C001"</span>, <span class="st">"S158C001"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>well_assignments <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plate_Number =</span> <span class="fu">sample</span>(plate_number_12_well),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Well_Placements =</span> <span class="fu">sample</span>(well_placements),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Conditions =</span> <span class="fu">sample</span>(conditions),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal_ID =</span> <span class="fu">sample</span>(animal_id)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(well_assignments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Plate_Number Well_Placements Conditions animal_ID
1             1              A2 45 mg/L R4  S151C001
2             1              B4  5 mg/L R1  S147C001
3             1              B2 45 mg/L R3  S178C001
4             1              B1  5 mg/L R4  S180C001
5             1              A1  5 mg/L R3  S160C001
6             1              A3  5 mg/L R2  S167C001
7             1              A4 Control R3  S154C001
8             1              C4 Control R1  S177C001
9             1              B3 45 mg/L R1  S158C001
10            1              C2 Control R4  S148C001
11            1              C1 Control R2  S149C001
12            1              C3 45 mg/L R2  S162C001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#save assignments in csv for downstream use as metadata</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(well_assignments, <span class="at">file =</span> <span class="st">"pilot_random_assignments.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plate assignments</figcaption>
</figure>
</div>
</section>
<section id="nickel-chloride-dilutions" class="level2">
<h2 class="anchored" data-anchor-id="nickel-chloride-dilutions">Nickel Chloride Dilutions</h2>
<p>Review resources prior to handling nickel chloride:</p>
<ul>
<li><p>Nickel chloride <a href="https://www.fishersci.com/store/msds?partNumber=AC270510050&amp;productDescription=NICKEL%28II%29+CHLORIDE+HEXA+5KG&amp;vendorId=VN00032119&amp;countryCode=US&amp;language=en">SDS</a>.</p></li>
<li><p><a href="https://amo-csd.lbl.gov/downloads/Chemical%20Resistance%20of%20Gloves.pdf">Chemical resistance of gloves.</a></p></li>
</ul>
<p>All handling of stock solution and treatments to be done in a chemical fume hood. Once spiked water has been distributed, add animals, parafilm jars, place in secondary container, and move to environmental chamber.</p>
<section id="required-volume-of-artificial-seawater" class="level3">
<h3 class="anchored" data-anchor-id="required-volume-of-artificial-seawater">Required Volume of Artificial Seawater</h3>
<p>Calculations for spiking artificial seawater. 225 mL of seawater required to mostly submerge glass slide in wide mouth 16 oz Kerr mason jar.</p>
<p>Considerations:</p>
<ul>
<li><p>4 replicates</p></li>
<li><p>225 mL per jar</p></li>
<li><p>3 conditions</p></li>
<li><p>Account for 10% loss of water during transferring</p></li>
</ul>
<p><span class="math display">\[(4*225 * 3) + (0.1*(4*225*3)) = 2,970\]</span></p>
<p>Need 2,970 mL of artificial seawater total for exposure, particularly, 990 mL of artificial seawater per condition.</p>
</section>
<section id="calculations" class="level3">
<h3 class="anchored" data-anchor-id="calculations">Calculations</h3>
<p>Stock solution of NiCl<sub>2</sub> made by undergraduate Gina Jones on 02/08/23.</p>
<ul>
<li><p>NiCl<sub>2</sub></p></li>
<li><p>Suspended in MilliQ water (0 PPT)</p></li>
</ul>
<section id="low-dose-5-mgl" class="level4">
<h4 class="anchored" data-anchor-id="low-dose-5-mgl">Low Dose: 5 mg/L</h4>
<p><span class="math display">\[ C_1*V_1 = C_2*V_2\]</span> <span class="math display">\[ 1 g/L * V_1 = 0.005g/L*0.99L\]</span> <span class="math display">\[V_1 = 0.00495 L = 4.95 mL\]</span> Spike 990 mL of aerated, artificial seawater (16 C) with 4.95 mL of stock NiCl<sub>2</sub> solution. Change in salinity negligible (+/- 1 PPT).</p>
</section>
<section id="high-dose-45-mgl" class="level4">
<h4 class="anchored" data-anchor-id="high-dose-45-mgl">High Dose: 45 mg/L</h4>
<p><span class="math display">\[ C_1*V_1 = C_2*V_2\]</span> <span class="math display">\[ 1 g/L * V_1 = 0.045g/L*0.99L\]</span> <span class="math display">\[V_1 = 0.04455 L = 44.55 mL\]</span> Spike 990 mL of aerated, artificial seawater (16 C) with 44.55 mL of stock NiCl<sub>2</sub> solution. Change in salinity negligible (+/- 1 PPT).</p>
</section>
</section>
</section>
</section>
<section id="protocol" class="level1">
<h1>Protocol</h1>
<ol type="1">
<li><p>Subdivide animals 3 days prior to exposure start.</p></li>
<li><p>Make sufficient volume of artificial seawater at appropriate salinity, 25 PPT, to match recirculating seawater system parameters. In this case for a 3 x 4 exposure at 250 mL, will require about 7 L of artificial seawater.</p></li>
</ol>
<ul>
<li>30.8 g / L of Red Sea Salt</li>
</ul>
<ol start="3" type="1">
<li>Rinse all glassware to be used during exposure as follows:</li>
</ol>
<ul>
<li><p>Triplicate rinse with lab detergent</p></li>
<li><p>Triplicate rinse with tap water</p></li>
<li><p>Triplicate rinse with DI water</p></li>
</ul>
<ol start="4" type="1">
<li><p>Add lab bench paper to environmental chambers top rack to reduce light intensity. Include 4 slits in bench paper to allow for air flow.</p></li>
<li><p>Add 1000 mL of artificial seawater to three 1 L beakers and place in environmental chamber (set to ambient 23 C to achieve 16 C for water) with gentle aeration (targeting ~ 67 % DO) in preparation the night before exposure.</p></li>
</ol>
<section id="day-of-exposure-commencement" class="level4">
<h4 class="anchored" data-anchor-id="day-of-exposure-commencement"><em>Day of Exposure Commencement</em></h4>
<ol start="6" type="1">
<li><p>Take 10 mL from each 1 L beaker and document temperature, DO, pH, salinity, and ammonia of artificial seawater prior to spiking the water.</p></li>
<li><p>In a chemical fume hood add the appropriate volume to achieve desired concentration of nickel chloride concentration to each of the 1 L beakers using a 25 mL or 50 mL serological pipette. Be sure to homogenize solution well with the serological pipette. Distribute 225 mL of each stock to the appropriate mason jar or beaker using designated serological pipette.</p></li>
<li><p>Transfer animals to a portable container with artificial seawater from the recirculating system. Image the animals using the Excelis stereomicroscope. Use a razor blade to clean around the animal and to clean glass slide of excess algae and debris.</p></li>
</ol>
<ul>
<li>Document stage, zooid number, cumulative system number.</li>
</ul>
<ol start="9" type="1">
<li><p>Distribute animals to appropriate jar in fume hood.</p></li>
<li><p>Parafilm jar and place in secondary container.</p></li>
<li><p>Transfer secondary container with jars to second rack of environmental chamber.</p></li>
<li><p>Leave animals for 24 hours.</p></li>
</ol>
</section>
<section id="day-of-dissections" class="level4">
<h4 class="anchored" data-anchor-id="day-of-dissections"><em>Day of Dissections</em></h4>
<p>Order of Takedown:</p>
<ol type="1">
<li>5-R3</li>
<li>45-R4</li>
<li>5-R2</li>
<li>0-R3</li>
<li>5-R4</li>
<li>45-R3</li>
<li>45-R1</li>
<li>5-R1</li>
<li>0-R2</li>
<li>0-R4</li>
<li>45-R2</li>
<li>0-R1</li>
</ol>
<p>The following steps should be conducted in a chemical fume hood and iterated through one beaker at a time to avoid desiccation stress:</p>
<ol start="13" type="1">
<li><p>Remove 100% of the exposure water from beaker and dispose of NiCl<sub>2</sub> dosed artificial seawater in the appropriately marked hazardous waste container.</p></li>
<li><p>With the animal and glass slide still in the beaker, quadruplicate rinse the glass slide and animal with deionized water.</p></li>
<li><p>Glass slide may now be handled with nitrile gloves and should be quadruplicate rinsed with artificial seawater over exposure beaker.</p></li>
<li><p>Transfer glass slide and animal to a fresh 16 oz mason jar containing 200 mL of 15 C artificial seawater.</p></li>
<li><p>Dispose of excess liquid in exposure beaker in appropriately labeled hazardous waste container.</p></li>
</ol>
<p>You may now work outside the chemical fumehood. Note there may be residual NiCl<sub>2</sub> in animal so continue to wear the appropriate PPE and work carefully.</p>
<ol start="18" type="1">
<li><p>Using a stainless steel razor blade, remove one of the two cumulative systems on the glass slide. Use forceps to transfer cumulative system to appropriately labeled snap cap 1.5 mL eppendorf PCR safe tube containing 500 uL of RNAProtect by Qiagen.</p></li>
<li><p>Proceed with dissection of the primary buds or zooids of the second cumulative system on the slide. Refer to <a href="https://valeste.github.io/tough-tunicates/posts/epi-isolation-protocol/">epithelial isolation protocol</a></p></li>
</ol>
<ul>
<li>However, avoid using any ethanol in this procedure.</li>
</ul>
<ol start="20" type="1">
<li><p>Once tissue has been removed, take cell strainer and rinse it with 30 mL ASW-PSA.</p></li>
<li><p>Place tissue in aliquot of TCM and immediately go to seed tissue in biosaftey cabinet. Mark time of seeding.</p></li>
<li><p>No replacement of media over course of trial.</p></li>
<li><p>Transfer samples containing cumulative system suspended in RNAProtect to -20 C freezer overnight. The following day, transfer samples to -80 C freezer for long term storage.</p></li>
</ol>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="curling-google-sheet" class="level2">
<h2 class="anchored" data-anchor-id="curling-google-sheet">Curling Google Sheet</h2>
<p>Make sure you have made your Google sheet publicly available to anyone that has the link. If you make any updates to the sheet just re-curl the data, meaning just re-run the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-L</span> https://docs.google.com/spreadsheets/d/10uM3N3PD9xIP4yUnadfhkcXa8TPMRMD-adOIKbmkYzY/export<span class="pp">?</span>exportFormat=csv <span class="kw">|</span> <span class="fu">tee</span> ~/tough-tunicates/posts/nicl2-botryllus-pilot/data/morph.csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-clean-up" class="level2">
<h2 class="anchored" data-anchor-id="data-clean-up">Data clean up</h2>
<p>Read in the data into your environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>morph <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data/morph.csv"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Manipulate and clean up data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>morph<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">mdy</span>(morph<span class="sc">$</span>date) <span class="co">#convert the date column from characters to true date</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>morph <span class="ot">&lt;-</span> morph <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(jar_id, <span class="fu">c</span>(<span class="st">"treatment_mg_per_L"</span>, <span class="st">"replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="co">#create two new columns, treatment and replicate from jar id </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>morph_fact <span class="ot">&lt;-</span> morph <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment_mg_per_L =</span> <span class="fu">as.factor</span>(treatment_mg_per_L)) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage =</span> <span class="fu">as.factor</span>(stage)) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal_id =</span> <span class="fu">as.factor</span>(animal_id)) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.factor</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment_order =</span> <span class="fu">factor</span>(<span class="fu">paste</span>(treatment_mg_per_L, animal_id))) <span class="co"># Create a new variable for ordering by treatment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(morph_fact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         date      initials         stage       hpe     treatment_mg_per_L
 2023-09-29:12   Length:24          A1:1   Min.   : 0   0 :8              
 2023-09-30:12   Class :character   A2:1   1st Qu.: 0   45:8              
                 Mode  :character   B1:4   Median :12   5 :8              
                                    B2:3   Mean   :12                     
                                    C1:5   3rd Qu.:24                     
                                    C2:6   Max.   :24                     
                                    TO:4                                  
  replicate            animal_id      no_sys       no_prim_sys1  
 Length:24          S147C001: 2   Min.   :1.000   Min.   : 7.00  
 Class :character   S148C001: 2   1st Qu.:1.000   1st Qu.: 8.00  
 Mode  :character   S149C001: 2   Median :1.000   Median :10.50  
                    S151C001: 2   Mean   :1.458   Mean   :10.83  
                    S154C001: 2   3rd Qu.:2.000   3rd Qu.:13.00  
                    S158C001: 2   Max.   :2.000   Max.   :22.00  
                    (Other) :12                                  
  no_prim_sys2       image             comments            treatment_order
 Min.   : 0.000   Length:24          Length:24          0 S148C001 : 2    
 1st Qu.: 0.000   Class :character   Class :character   0 S149C001 : 2    
 Median : 3.000   Mode  :character   Mode  :character   0 S154C001 : 2    
 Mean   : 4.667                                         0 S177C001 : 2    
 3rd Qu.: 8.250                                         45 S151C001: 2    
 Max.   :14.000                                         45 S158C001: 2    
                                                        (Other)    :12    </code></pre>
</div>
</div>
</section>
<section id="exploratory-plots" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-plots">Exploratory plots</h2>
<p>Lollipop chart to visualize the jumps or arrests in blastogenic stage progression for each animal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> morph_fact, <span class="fu">aes</span>(<span class="at">x =</span> stage, <span class="at">y =</span> treatment_order, <span class="at">color =</span> date)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">h =</span> <span class="fl">0.1</span>, <span class="at">w =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> treatment_order), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'grey'</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Blastogenic Stage Change Over Two Days"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Stage"</span>, <span class="at">y =</span> <span class="st">"Treatment Group - Animal ID"</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analyzing-differences-in-blastogenic-progression-across-treatments" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-differences-in-blastogenic-progression-across-treatments">Analyzing differences in blastogenic progression across treatments</h2>
<p>Since all the animals start at different blastogenic stages, we will need to quantify changes in blastogenic rate with a numeric scale</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a numeric scale</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>blastogenic_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"TO"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>numeric_scale <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new variable with the numeric scale</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>morph <span class="ot">&lt;-</span> morph <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stage_numeric =</span> <span class="fu">as.integer</span>(<span class="fu">factor</span>(stage, <span class="at">levels =</span> blastogenic_scale, <span class="at">labels =</span> numeric_scale)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(morph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      date              initials            stage                hpe    
 Min.   :2023-09-29   Length:24          Length:24          Min.   : 0  
 1st Qu.:2023-09-29   Class :character   Class :character   1st Qu.: 0  
 Median :2023-09-29   Mode  :character   Mode  :character   Median :12  
 Mean   :2023-09-29                                         Mean   :12  
 3rd Qu.:2023-09-30                                         3rd Qu.:24  
 Max.   :2023-09-30                                         Max.   :24  
 treatment_mg_per_L  replicate          animal_id             no_sys     
 Length:24          Length:24          Length:24          Min.   :1.000  
 Class :character   Class :character   Class :character   1st Qu.:1.000  
 Mode  :character   Mode  :character   Mode  :character   Median :1.000  
                                                          Mean   :1.458  
                                                          3rd Qu.:2.000  
                                                          Max.   :2.000  
  no_prim_sys1    no_prim_sys2       image             comments        
 Min.   : 7.00   Min.   : 0.000   Length:24          Length:24         
 1st Qu.: 8.00   1st Qu.: 0.000   Class :character   Class :character  
 Median :10.50   Median : 3.000   Mode  :character   Mode  :character  
 Mean   :10.83   Mean   : 4.667                                        
 3rd Qu.:13.00   3rd Qu.: 8.250                                        
 Max.   :22.00   Max.   :14.000                                        
 stage_numeric  
 Min.   :1.000  
 1st Qu.:3.750  
 Median :5.000  
 Mean   :4.833  
 3rd Qu.:6.000  
 Max.   :7.000  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by treatment and animal_id, then count stage skips</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>skips_data <span class="ot">&lt;-</span> morph <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment_mg_per_L, animal_id) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">skips =</span> <span class="fu">max</span>(stage_numeric) <span class="sc">-</span> <span class="fu">min</span>(stage_numeric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment_mg_per_L'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard deviations for each treatment</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> skips_data <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment_mg_per_L) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">std_dev =</span> <span class="fu">sd</span>(skips))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate means for each treatment</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>means_data <span class="ot">&lt;-</span> skips_data <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment_mg_per_L) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_skips =</span> <span class="fu">mean</span>(skips))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(std_dev, means_data, <span class="at">by =</span> <span class="st">"treatment_mg_per_L"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  treatment_mg_per_L std_dev mean_skips
  &lt;chr&gt;                &lt;dbl&gt;      &lt;dbl&gt;
1 0                     0.5        1.25
2 45                    1.89       1.25
3 5                     1.41       2   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar graph with adjusted error bars</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>bar_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> treatment_mg_per_L, <span class="at">y =</span> mean_skips, <span class="at">fill =</span> treatment_mg_per_L)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmax</span>(mean_skips <span class="sc">-</span> std_dev, <span class="dv">0</span>), <span class="at">ymax =</span> mean_skips <span class="sc">+</span> std_dev), </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Blastogenic Stage Skips by Treatment"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Treatment (mg/L)"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Skips"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the bar graph</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bar_plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a Kruskal-Wallis test to compare the treatments</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(combined_data<span class="sc">$</span>mean_skips <span class="sc">~</span> combined_data<span class="sc">$</span>treatment_mg_per_L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  combined_data$mean_skips by combined_data$treatment_mg_per_L
Kruskal-Wallis chi-squared = 2, df = 2, p-value = 0.3679</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This page is built using <a href="https://quarto.org/">Quarto</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>