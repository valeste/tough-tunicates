---
title: "SOD assay for nickel LC50 samples"
author: "Celeste Valdivia"
date: "2024-07-03"
---

```{r, eval =TRUE, message=FALSE}
library(knitr)
library(tidyverse)
library(tidyr)
library(dplyr)
library(hrbrthemes)
library(ggplot2)
library(car)
library(RColorBrewer)
library(ggpubr)
knitr::opts_chunk$set(echo = TRUE,
                      eval = TRUE)
```
# Background
An LC50 determination for nickel on *Botryllus schlosseri* was completed in Spring Quarter 2024. Specimens were snap frozen at the 24 and 96 hour mark to assess for accumulation of Superoxide Dismutase 1 (SOD1). SOD1 is an endogenous antioxidant with a primary function involving the removal of reactive oxygen species (ROS). 

Nickel genotoxicity functions indirectly through the resultant intracellular accumulation of ROS in most animal cells. ROS cause double and single stranded breaks to the DNA which inevitably may result in mutations forming at the cellular attempts to repair the DNA.

Here we explore the effects of increasing concentrations of nickel on the accumulation of SOD1 in *B. schlosseri*.


# Retrieving Data from Google Sheets

Make sure you have made your Google sheet publicly available to anyone that has the link. If you make any updates to the sheet just re-curl the data, meaning just re-run the code below.

I apologize for not making a relative path. Just modify what is after "tee" to your own directory path.

```{r, engine='bash', eval=FALSE}
curl -L https://docs.google.com/spreadsheets/d/1vNxX2tBdEa0Ibyd4mFdru5sAZx0aipv37-y-hkqvJq4/export?exportFormat=csv | tee /Users/valeste/Documents/Git/tough-tunicates/posts/LC50-SOD/SOD.csv
```

```{r}
sod <- read.csv("SOD.csv")
head(sod)
```

Note that as of July 3, 2024, the data set for the 10 mg/L is incomplete in this data frame and should be taken with a grain of salt.

# Work Data

```{r}
df_clean <- sod %>%
  filter(!is.na(sod_calc))
```


Average the technical replicates
```{r}
df_avg <- df_clean %>%
  group_by(hom_num, treatment, hpe) %>%
  summarize(
    sod_avg = mean(sod_calc, na.rm = TRUE),
    sod_se = sd(sod_calc, na.rm = TRUE) / sqrt(n())
  )
```

# Exploratory Plots

```{r, eval=TRUE}

ggplot(df_avg, aes(x = factor(treatment), y = sod_avg, fill = factor(treatment))) +
  geom_violin(trim = FALSE) +
  facet_wrap(~ hpe, scales = "free_y") +
  labs(title = "Violin Plot of SOD Activity by Treatment and HPE",
       x = "Treatment",
       y = "SOD Activity") +
  theme_minimal()
```


```{r, eval=TRUE}
ggplot(df_avg, aes(x = factor(treatment), y = sod_avg, fill = factor(treatment))) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = sod_avg - sod_se, ymax = sod_avg + sod_se), width = 0.2, position = position_dodge(0.9)) +
  facet_wrap(~ hpe, ncol = 1) +
  labs(title = "SOD Activity by Treatment and HPE",
       x = "Treatment",
       y = "Average SOD Activity (with SE)") +
  theme_minimal()
```

Note that we have yet to complete the BCA assay for these samples and so the above figures may change.

# Stats Analysis

```{r}
# Perform ANOVA
anova_result <- aov(sod_avg ~ hpe * treatment, data = df_avg)

# Summarize ANOVA results
summary(anova_result)
```

